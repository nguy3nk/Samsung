"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],s=!0,d=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(s=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){d=!0,a=e}finally{try{s||null==o.return||o.return()}finally{if(d)throw a}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(e){e.controller("checkoutControllerVN",["$scope","$rootScope","angularUtils","$timeout","checkoutService","AddressService",function(e,t,i,s,d,a){e.settings.showDeliveryMethod=!0,e.settings.allowBlankPostCode=!0,e.showShippingFields=!0,e.showBillingFields=!0,e.hideDeliveryModeThumb=!0,e.showClickCollectDetails=!0,e.paymentBanner=!0,e.selectedClickAndCollect=null,e.init=function(){i.ObjectAssignFunctionIE(),e.step=e.step||1,e.selectedAddresses=[],e.getDeliveryMethodData(""),e.getAllData(),e.noaddressText=ACC.qasNoAddressText,e.bulkOrderStore=ACC.bulkOrder,e.searchLookup=[],e.isDeliveryModeInit=!0,e.isShipToStoreSupported=e.cartCheckoutData.isShipToStoreSupported,e.loginType=ACC.loginType,e.showSSavedAddress=!1,e.showBSavedAddress=!1,e.hasBillingAddress=!1,e.hasShippingAddress=!1,e.encodedContextPath=ACC.config.encodedContextPath,s(function(){e.CHECKOUT_OPTIONS.marketingOptIn=!0,e.initCheckoutForm(),e.isShipToStoreSupported&&"SSO_GENID"===e.loginType?e.setDeliveryOption("ship-to-store"):e.isShipToStoreSupported?e.cartCheckoutData.deliveryAddress&&e.cartCheckoutData.deliveryAddress.shipToStoreStoreId?e.setDeliveryOption("ship-to-store"):e.setDeliveryOption("standardDelivery"):e.deliveryOption="standardDelivery",ACC.isShipToStoreActive&&document.querySelector(".nav-selections [href='#shipToStore']").click(),e.updateAddressSessionState()}),e.setShowTaxes(),t.$on("OnSet_CheckoutInfo",function(t){e.hasSavedAddresses()})},e.stepPaymentDetailsInit=function(){e.encodedContextPath=ACC.config.encodedContextPath,s(function(){void 0!==$(".global-alerts").html()&&(e.errorMessage=0!==$(".global-alerts").html().length),e.toggleSummary=!0,e.$on("breakpointChange",function(t,i,s){i.windowSize>640&&(e.toggleSummary=!0)}),e.getPaymentData(),e.initThemes(),e.setShowTaxes(),e.isOfflinePickup()&&(e.deliveryModeHeading=ACC.deliveryHeadingClickAndCollect,e.combineDeliveryGroups())})},e.isInstallation=function(e){return!(!e.selectedDeliveryMode||!e.selectedDeliveryMode.code||"vn-installation"!==e.selectedDeliveryMode.code)},e.isOfflinePickup=function(){var t=e.delivery;return void 0!==t&&null!==t&&void 0!==t.shipToStoreStoreId&&null!==t.shipToStoreStoreId&&""!==t.shipToStoreStoreId},e.combineDeliveryGroups=function(){for(var t=[],i=0;i<e.deliveryGroups.length;i++)for(var s=e.deliveryGroups[i],d=0;d<s.length;d++)t.push(s[d]);e.deliveryGroups=[t]},e.setDeliveryOption=function(t){e.deliveryOption=t,s(function(){switch(e.deliveryOption){case"ship-to-store":e.deliveryOption="ship-to-store",e.showBilling=!0,e.hideSameAsShipping=!0,e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1,e.showBSavedAddress=!1,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!0,e.resetNewAddressForm("billing");break;case"standardDelivery":e.deliveryOption="standardDelivery",e.hideSameAsShipping=!1,e.shipToStoreId="",e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0,e.updateShippingDeliveryModes();break;default:e.deliveryOption="ship-to-store",e.showBilling=!0,e.hideSameAsShipping=!0,e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1,e.showBSavedAddress=!1,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!0,e.resetNewAddressForm("billing"),e.cartCheckoutData.billingAddress||e.resetNewAddressForm("billing")}}),ACC.currentStoreBulkOrder&&(e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1)},e.initCheckoutForm=function(){e.advanceErrors=null,ACC.currentStoreBulkOrder||(e.CHECKOUT_SHIPPING_ADDRESS.district_disabled=!0,e.CHECKOUT_SHIPPING_ADDRESS.ward_disabled=!0,e.CHECKOUT_SHIPPING_ADDRESS.addressSelection="s_New"),e.CHECKOUT_BILLING_ADDRESS.district_disabled=!0,e.CHECKOUT_BILLING_ADDRESS.ward_disabled=!0,e.CHECKOUT_BILLING_ADDRESS.addressSelection="b_New",e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0,angular.isDefined(e.cartCheckoutData.deliveryAddress)&&(e.definedLName=angular.isDefined(e.cartCheckoutData.deliveryAddress.lastName)?e.cartCheckoutData.deliveryAddress.lastName:"",e.definedFName=angular.isDefined(e.cartCheckoutData.deliveryAddress.firstName)?e.cartCheckoutData.deliveryAddress.firstName:"",e.definedFullName="".concat(e.definedLName," ").concat(e.definedFName),""!==e.definedLName&&""!==e.definedFName||(e.definedFullName=""),e.CHECKOUT_SHIPPING_ADDRESS&&(e.CHECKOUT_SHIPPING_ADDRESS.fullName=e.definedFullName,e.CHECKOUT_SHIPPING_ADDRESS.phone=e.cartCheckoutData.deliveryAddress.phone,e.CHECKOUT_SHIPPING_ADDRESS.phoneNumber2=e.cartCheckoutData.deliveryAddress.phone2,e.CHECKOUT_SHIPPING_ADDRESS.line1=e.cartCheckoutData.deliveryAddress.line1,e.CHECKOUT_SHIPPING_ADDRESS.line2=e.cartCheckoutData.deliveryAddress.line2,e.CHECKOUT_SHIPPING_ADDRESS.regionIso=angular.isDefined(e.cartCheckoutData.deliveryAddress.region)?e.cartCheckoutData.deliveryAddress.region.isocode:"",e.CHECKOUT_SHIPPING_ADDRESS.district=angular.isDefined(e.cartCheckoutData.deliveryAddress.district)?e.cartCheckoutData.deliveryAddress.district:"",e.CHECKOUT_SHIPPING_ADDRESS.ward=e.cartCheckoutData.deliveryAddress.town,e.CHECKOUT_SHIPPING_ADDRESS.village=e.cartCheckoutData.deliveryAddress.birthCity,e.CHECKOUT_SHIPPING_ADDRESS.deliveryInfo=e.cartCheckoutData.deliveryAddress.deliveryInfo,angular.isDefined(e.CHECKOUT_SHIPPING_ADDRESS.regionIso)&&e.CHECKOUT_SHIPPING_ADDRESS.regionIso.length&&(e.CHECKOUT_SHIPPING_ADDRESS.district_disabled=!1),angular.isDefined(e.CHECKOUT_SHIPPING_ADDRESS.district)&&""!==e.CHECKOUT_SHIPPING_ADDRESS.district&&(e.CHECKOUT_SHIPPING_ADDRESS.ward_disabled=!1))),e.CHECKOUT_BILLING_ADDRESS.savedAddressOption||angular.isDefined(e.cartCheckoutData.billingAddress)&&(e.CHECKOUT_BILLING_ADDRESS.fullName=angular.isDefined(e.cartCheckoutData.billingAddress.lastName&&e.cartCheckoutData.billingAddress.firstName)?"".concat(e.cartCheckoutData.billingAddress.lastName," ").concat(e.cartCheckoutData.billingAddress.firstName):"",e.CHECKOUT_BILLING_ADDRESS.companyTaxNumber=null!=e.cartCheckoutData.billingAddress.companyTaxNumber?e.cartCheckoutData.billingAddress.companyTaxNumber:"",e.CHECKOUT_BILLING_ADDRESS.phone=e.cartCheckoutData.billingAddress.phone,e.CHECKOUT_BILLING_ADDRESS.phoneNumber2=e.cartCheckoutData.billingAddress.phone2,e.CHECKOUT_BILLING_ADDRESS.line1=e.cartCheckoutData.billingAddress.line1,e.CHECKOUT_BILLING_ADDRESS.line2=e.cartCheckoutData.billingAddress.line2,e.CHECKOUT_BILLING_ADDRESS.regionIso=angular.isDefined(e.cartCheckoutData.billingAddress.region)?e.cartCheckoutData.billingAddress.region.isocode:"",e.CHECKOUT_BILLING_ADDRESS.district=angular.isDefined(e.cartCheckoutData.billingAddress.district)?e.cartCheckoutData.billingAddress.district:"",e.CHECKOUT_BILLING_ADDRESS.ward=e.cartCheckoutData.billingAddress.town,e.CHECKOUT_BILLING_ADDRESS.village=e.cartCheckoutData.billingAddress.birthCity,e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=e.cartCheckoutData.billingAddress.billingAddress,angular.isDefined(e.CHECKOUT_BILLING_ADDRESS.regionIso)&&e.CHECKOUT_BILLING_ADDRESS.regionIso.length&&(e.CHECKOUT_BILLING_ADDRESS.district_disabled=!1),angular.isDefined(e.CHECKOUT_BILLING_ADDRESS.district)&&""!==e.CHECKOUT_BILLING_ADDRESS.district&&(e.CHECKOUT_BILLING_ADDRESS.ward_disabled=!1)),e.$watch("CHECKOUT_SHIPPING_ADDRESS.regionIso",function(t){void 0!==t&&""!==t&&a.getDistricts(t).then(function(t){angular.isArray(t)&&t.length&&(e.CHECKOUT_SHIPPING_ADDRESS.district_disabled=!1,e.CHECKOUT_SHIPPING_ADDRESS.district_items=a.districtsConverter(t),void 0!==e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_district&&null!==e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_district&&(e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_district.$touched=!0))})}),e.$watch("CHECKOUT_SHIPPING_ADDRESS.district",function(t){if(void 0===t||""===t||null===t)return e.CHECKOUT_SHIPPING_ADDRESS.ward="",void(e.CHECKOUT_SHIPPING_ADDRESS.ward_items={});a.getWards(t).then(function(t){angular.isArray(t)&&t.length&&(e.CHECKOUT_SHIPPING_ADDRESS.ward_disabled=!1,e.CHECKOUT_SHIPPING_ADDRESS.ward_items=a.wardsConverter(t),void 0!==e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_ward&&null!==e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_ward&&(e.CHECKOUT_SHIPPING_ADDRESS.CHECKOUT_SHIPPING_ADDRESS_ward.$touched=!0))})}),e.$watch("CHECKOUT_BILLING_ADDRESS.regionIso",function(t){void 0!==t&&""!==t&&a.getDistricts(t).then(function(t){angular.isArray(t)&&t.length&&(e.CHECKOUT_BILLING_ADDRESS.district_disabled=!1,e.CHECKOUT_BILLING_ADDRESS.district_items=a.districtsConverter(t),void 0!==e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_district&&null!==e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_district&&(e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_district.$touched=!0))})}),e.$watch("CHECKOUT_BILLING_ADDRESS.district",function(t){if(void 0===t||""===t)return e.CHECKOUT_BILLING_ADDRESS.ward="",void(e.CHECKOUT_BILLING_ADDRESS.ward_items={});a.getWards(t).then(function(t){angular.isArray(t)&&t.length&&(e.CHECKOUT_BILLING_ADDRESS.ward_disabled=!1,e.CHECKOUT_BILLING_ADDRESS.ward_items=a.wardsConverter(t),void 0!==e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_ward&&null!==e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_ward&&(e.CHECKOUT_BILLING_ADDRESS.CHECKOUT_BILLING_ADDRESS_ward.$touched=!0))})})},e.hasSavedAddresses=function(){ACC.currentStoreBulkOrder?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1:(e.isShipToStoreSupported&&"SSO_GENID"===e.loginType?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1:e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0,e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!0);var t=e.checkoutInfo.addresses;if(i.isLoggedIn()){e.isLoggedIn=!0,e.shipping=[],e.billing=[];var s=t.filter(function(e){return e.country&&"VN"===e.country.isocode});for(var d in s)!0===s[d].shippingAddress&&!0===s[d].visibleInAddressBook?(e.hasShippingAddress=!0,e.savedAddressSelected=!0,e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!1,e.isShipToStoreSupported&&"SSO_GENID"===e.loginType?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1:e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0,e.showSSavedAddress=!0,e.shipping.push(s[d])):!1===s[d].visibleInAddressBook&&(e.showSSavedAddress=!1,e.savedAddressSelected=!0,e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!1),1==s[d].billingAddress&&1==s[d].visibleInAddressBook&&(e.hasBillingAddress=!0,e.savedAddressSelected=!0,e.isShipToStoreSupported&&"SSO_GENID"===e.loginType?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1:e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0,e.showBSavedAddress=!0,e.billing.push(s[d]));e.checkoutInfo.defaultShippingAddress?e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.checkoutInfo.defaultShippingAddress.id:e.shipping.length&&(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.shipping[0].id),e.checkoutInfo.defaultBillingAddress?e.CHECKOUT_BILLING_ADDRESS.addressId=e.checkoutInfo.defaultBillingAddress.id:e.billing.length&&(e.CHECKOUT_BILLING_ADDRESS.addressId=e.billing[0].id),e.shipping.length>0?(e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!1,e.showSSavedAddress=!0,e.savedAddressSelected=!0):(e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!0,e.showSSavedAddress=!1,e.savedAddressSelected=!1)}e.setDeliveryOption(e.deliveryOption),void 0!==e.cartCheckoutData.billingAddress&&null!==e.cartCheckoutData.billingAddress&&void 0!==e.cartCheckoutData.deliveryAddress&&null!==e.cartCheckoutData.deliveryAddress&&(e.cartCheckoutData.billingAddress.formattedAddress==e.cartCheckoutData.deliveryAddress.formattedAddress?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0:(e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!0,e.showBSavedAddress=!1))},e.updateShippingAddress=function(){if(null!==e.selectedClickAndCollect&&(e.CHECKOUT_SHIPPING_ADDRESS.fullName="",e.CHECKOUT_SHIPPING_ADDRESS.line1=e.selectedClickAndCollect.address.line1,e.CHECKOUT_SHIPPING_ADDRESS.line2=e.selectedClickAndCollect.address.line2,e.CHECKOUT_SHIPPING_ADDRESS.postalCode="",e.CHECKOUT_SHIPPING_ADDRESS.town=e.selectedClickAndCollect.address.town,e.CHECKOUT_SHIPPING_ADDRESS.district=e.selectedClickAndCollect.address.district,e.CHECKOUT_SHIPPING_ADDRESS.phone="",e.CHECKOUT_SHIPPING_ADDRESS.phoneNumber2="",e.CHECKOUT_SHIPPING_ADDRESS.village="",e.CHECKOUT_SHIPPING_ADDRESS.ward="",e.CHECKOUT_SHIPPING_ADDRESS.deliveryInfo="","ship-to-store"===e.deliveryOption)){for(var t,i=e.billing||[],s=e.CHECKOUT_BILLING_ADDRESS.addressId,d=0;d<i.length;++d)if(i[d].id==s){t=d;break}if(0==e.showBSavedAddress)e.CHECKOUT_SHIPPING_ADDRESS.fullName=e.CHECKOUT_BILLING_ADDRESS.fullName;else{e.CHECKOUT_SHIPPING_ADDRESS.fullName="".concat(i[t].lastName," ").concat(i[t].firstName);var a={fullName:"".concat(i[t].lastName," ").concat(i[t].firstName),companyTaxNumber:i[t].companyTaxNumber?i[t].companyTaxNumber:"",phone:i[t].phone,phoneNumber2:i[t].phone2,line1:i[t].line1,line2:i[t].line2,regionIso:i[t].region?i[t].region.isocode:"",district:i[t].district?i[t].district:"",ward:i[t].town,village:i[t].birthCity};Object.assign(e.CHECKOUT_BILLING_ADDRESS,a)}null!==e.selectedClickAndCollect.address.region.isocode?e.CHECKOUT_SHIPPING_ADDRESS.regionIso=e.selectedClickAndCollect.address.region.isocode:e.CHECKOUT_SHIPPING_ADDRESS.regionIso="".concat(ACC.config.storeUid.toUpperCase(),"-").concat(e.selectedClickAndCollect.address.region.isocode)}},e.updateAddressSessionState=function(){void 0!==e.cartCheckoutData.deliveryAddress&&(e.cartCheckoutData.billingAddress.formattedAddress==e.cartCheckoutData.deliveryAddress.formattedAddress?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0:(angular.element("#CHECKOUT_BILLING_ADDRESS_searchAddress_1_billing").closest("ng-form").find(".address-fields").addClass("active"),e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1),i.isLoggedIn()&&e.populateSessionSavedAddress()),void 0!==e.cartCheckoutData.billingAddress&&null!==e.cartCheckoutData.billingAddress&&void 0!==e.cartCheckoutData.deliveryAddress&&null!==e.cartCheckoutData.deliveryAddress&&(e.cartCheckoutData.billingAddress.formattedAddress==e.cartCheckoutData.deliveryAddress.formattedAddress?e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!0:(e.CHECKOUT_BILLING_ADDRESS.sameAsShipping=!1,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!0,e.showBSavedAddress=!1))},e.initThemes=function(){e.paymentDefault=!1,e.openPaymentDefault()},e.isClickAndCollect=function(e){return!(!e.selectedDeliveryMode||!e.selectedDeliveryMode.code||"vn-click-and-collect"!==e.selectedDeliveryMode.code)},e.formatAddress=function(){var t=e.billing;if(!e.bulkOrderStore){var i=e.delivery;void 0!==i.shipToStoreStoreId?i.shipToStoreStoreId&&i.shipToStoreStoreId.length>0&&(e.delAddressFormatted="<div>".concat(i.lastName," ").concat(i.firstName||"","<br>").concat(i.line1,"<br>").concat(i.region.name,"</div>")):(e.delAddressFormatted="<div>",void 0!==i.lastName&&(e.delAddressFormatted+="".concat(i.lastName," ")),void 0!==i.firstName&&(e.delAddressFormatted+="".concat(i.firstName,"<br>")),void 0!==i.line2&&(e.delAddressFormatted+="".concat(i.line2,"<br>")),e.delAddressFormatted+="".concat(i.line1,"<br>").concat(i.town,"<br>").concat(i.district,"<br>").concat(i.region.name,"<br>"),void 0!==i.birthCity&&(e.delAddressFormatted+="".concat(i.birthCity,"<br>")),void 0!==i.phone&&(e.delAddressFormatted+="".concat(i.phone,"<br>")),void 0!==i.phone2&&(e.delAddressFormatted+=i.phone2),e.delAddressFormatted+="</div>")}e.bilAddressFormatted="<div>",void 0!==t.lastName&&(e.bilAddressFormatted+="".concat(t.lastName," ")),void 0!==t.firstName&&(e.bilAddressFormatted+="".concat(t.firstName,"<br>")),void 0!==t.companyTaxNumber&&(e.bilAddressFormatted+="".concat(t.companyTaxNumber,"<br>")),void 0!==t.line2&&(e.bilAddressFormatted+="".concat(t.line2,"<br>")),e.bilAddressFormatted+="".concat(t.line1,"<br>").concat(t.town,"<br>").concat(t.district,"<br>").concat(t.region.name,"<br>"),void 0!==t.birthCity&&(e.bilAddressFormatted+="".concat(t.birthCity,"<br>")),void 0!==t.phone&&(e.bilAddressFormatted+=t.phone),e.bilAddressFormatted+="</div>"},e.resetNewAddressForm=function(t){["fullName","companyTaxNumber","line1","line2","town","regionIso","district","ward","phone","phoneNumber2","companyTax","village","deliveryInfo"].forEach(function(i){"shipping"===t?e.CHECKOUT_SHIPPING_ADDRESS[i]="":"billing"===t&&(e.CHECKOUT_BILLING_ADDRESS[i]="")})},e.updateSavedBillingToForm=function(){for(var t,i=e.billing||[],s=e.CHECKOUT_BILLING_ADDRESS.addressId,d=0;d<i.length;++d)if(i[d].id==s){t=d;break}e.CHECKOUT_SHIPPING_ADDRESS.fullName="".concat(i[t].lastName," ").concat(i[t].firstName);var a={fullName:"".concat(i[t].lastName," ").concat(i[t].firstName),companyTaxNumber:i[t].companyTaxNumber?i[t].companyTaxNumber:"",phone:i[t].phone,phoneNumber2:i[t].phone2,line1:i[t].line1,line2:i[t].line2,regionIso:i[t].region?i[t].region.isocode:"",district:i[t].district?i[t].district:"",ward:i[t].town,village:i[t].birthCity};Object.assign(e.CHECKOUT_BILLING_ADDRESS,a)},e.switchAddressDetails=function(t){var i=document.getElementsByClassName("shipping-dropdown"),s=document.getElementsByClassName("billing-dropdown");if(angular.element(i),angular.element(s),"CHECKOUT_SHIPPING_ADDRESS.savedAddressOption"==t){e.showSSavedAddress=!0,e.savedAddressSelected=!0,e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!1;var d=e.shipping?e.shipping.filter(function(t){return t.id==e.CHECKOUT_SHIPPING_ADDRESS.addressId}):[];d.length>0&&e.getDeliveryMethodData(d[0].postalCode)}else"CHECKOUT_SHIPPING_ADDRESS.newAddressOption"==t&&(e.showSSavedAddress=!1,e.savedAddressSelected=!1,e.CHECKOUT_SHIPPING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_SHIPPING_ADDRESS.newAddressOption=!0,e.resetNewAddressForm("shipping"));"CHECKOUT_BILLING_ADDRESS.savedAddressOption"==t?(e.showBSavedAddress=!0,e.savedAddressSelected=!0,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!1):"CHECKOUT_BILLING_ADDRESS.newAddressOption"==t&&(e.showBSavedAddress=!1,e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!1,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!0,e.resetNewAddressForm("billing"))},e.populateSessionAddress=function(t,i){e.setDeliveryOption(e.deliveryOption);var d=i.addresses[i.addresses.length-2],a={fullName:"".concat(d.lastName," ").concat(d.firstName),phone:d.phone,phoneNumber2:d.phone2,postalCode:d.postalCode,town:d.town,line1:d.line1,line2:d.line2,regionIso:d.region.isocode,district:d.district,ward:d.town,village:d.birthCity},n=i.addresses[i.addresses.length-1],o={fullName:"".concat(n.lastName," ").concat(n.firstName),phone:n.phone,companyTaxNumber:n.companyTaxNumber,postalCode:n.postalCode,line1:n.line1,line2:n.line2,regionIso:n.region.isocode,district:n.district,ward:n.town,village:n.birthCity};s(function(){e.bulkOrderStore||(null!=e.CHECKOUT_CUSTOMER_INFO&&Object.assign(e.CHECKOUT_CUSTOMER_INFO,customerInfo),null!=e.CHECKOUT_SHIPPING_ADDRESS&&Object.assign(e.CHECKOUT_SHIPPING_ADDRESS,a),null!=e.CHECKOUT_BILLING_ADDRESS&&Object.assign(e.CHECKOUT_BILLING_ADDRESS,o))})},e.stepCustomerDetailsSubmit=function(){"ship-to-store"==e.deliveryOption&&e.CHECKOUT_BILLING_ADDRESS.savedAddressOption&&e.updateSavedBillingToForm(),s(function(){e.standardDeliveryDisabled()&&"ship-to-store"!=e.deliveryOption||e.shipToStoreDisabled()&&"ship-to-store"==e.deliveryOption?(e.stepCustomerDetailsForm.$$controls.every(function(t,i){if(t.$invalid&&("CHECKOUT_SHIPPING_ADDRESS"!=t.$name||"ship-to-store"!=e.deliveryOption)){var s=t.$name;return angular.element("html, body").animate({scrollTop:$("#".concat(s)).offset().top-100},800),!1}return!0}),e.validateForms(e.stepCustomerDetailsForm.$error),$(".checkout-form-group .address-fields").addClass("active")):("ship-to-store"==e.deliveryOption?(e.updateShippingAddress(),e.stepCustomerDetailsForm.CHECKOUT_DELIVERY_MODES=e.storeDeliveryModes):e.stepCustomerDetailsForm.CHECKOUT_DELIVERY_MODES=e.shippingDeliveryModes,e.getMarketingOptIn(),e.postInProcess=!0,d.stepCustomerDetailsSend(angular.toJson(e.stepCustomerDetailsForm)).then(function(t){if(e.advanceErrors=null,void 0!==t.outOfStockProductData&&null!==t.outOfStockProductData&&(e.advanceErrors={outOfStockProductData:t.outOfStockProductData,posData:t.posData,stockCheckErrors:t.stockCheckErrors}),t.success&&null===e.advanceErrors)$(".checkout-page-container").addClass("checkout-is-loading"),window.location.href="".concat(window.location.origin+ACC.config.encodedContextPath,"/checkout/multi/delivery-address/next");else{e.postInProcess=!1,e.flowStepError=!!t.errors&&t.errors[0],$(".checkout-page-container").removeClass("checkout-is-loading");var i=$(".checkout-page-container");$("html,body").animate({scrollTop:i.position().top},1e3)}}))})},t.$on("OnLoad_ClickAndCollectData",function(i,d){e.clickAndCollectSourceData=d.clickAndCollect,null!==d&&void 0!==d&&1===d.clickAndCollect.length&&!0===d.autoSelectSingle&&1===e.clickAndCollectSourceData.length&&s(function(){t.$emit("OnSet_ClickAndCollect",{selectedAddress:d.clickAndCollect[0],index:0})})}),e.shipToStoreDisabled=function(){return!(e.bulkOrderStore||!e.CHECKOUT_BILLING_ADDRESS.$invalid&&e.hasShipToStoreId()&&e.CHECKOUT_OPTIONS.termsAndCondition)},e.onClickSameAsShipping=function(){e.CHECKOUT_BILLING_ADDRESS.savedAddressOption=!0,e.CHECKOUT_BILLING_ADDRESS.newAddressOption=!1,1==e.hasBillingAddress&&(e.showBSavedAddress=!0,e.setDefaultSavedAddress("billing"))},e.setDefaultSavedAddress=function(t){"shipping"==t&&void 0===e.CHECKOUT_SHIPPING_ADDRESS.addressId?void 0!==e.cartCheckoutData&&e.cartCheckoutData.deliveryAddress?e.checkDefaultAddress(e.cartCheckoutData.deliveryAddress,t)?(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.cartCheckoutData.deliveryAddress.id,e.getDeliveryMethodData(e.cartCheckoutData.deliveryAddress.postalCode)):e.shipping.length>0&&(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.shipping[0].id,e.getDeliveryMethodData(e.shipping[0].postalCode),e.useSavedAddress=!0):e.shipping.length>0&&(e.checkoutInfo.defaultShippingAddress?e.checkDefaultAddress(e.checkoutInfo.defaultShippingAddress,t)?(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.checkoutInfo.defaultShippingAddress.id,e.getDeliveryMethodData(e.checkoutInfo.defaultShippingAddress.postalCode),e.useDefaultShipping=!0):e.checkoutSettings.clickAndCollect.isEPP||e.checkoutSettings.clickAndCollect.shiptoStoreDefault||(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.shipping[0].id,e.getDeliveryMethodData(e.shipping[0].postalCode)):(e.CHECKOUT_SHIPPING_ADDRESS.addressId=e.shipping[0].id,e.getDeliveryMethodData(e.shipping[0].postalCode)),e.useSavedAddress=!0):"billing"==t&&void 0===e.CHECKOUT_BILLING_ADDRESS.addressId&&(void 0!==e.cartCheckoutData&&e.cartCheckoutData.billingAddress?e.checkDefaultAddress(e.cartCheckoutData.billingAddress,t)&&(e.CHECKOUT_BILLING_ADDRESS.addressId=e.cartCheckoutData.billingAddress.id):e.billing.length>0&&(e.checkoutInfo.defaultBillingAddress&&e.checkDefaultAddress(e.checkoutInfo.defaultBillingAddress,t)?e.CHECKOUT_BILLING_ADDRESS.addressId=e.checkoutInfo.defaultBillingAddress.id:e.CHECKOUT_BILLING_ADDRESS.addressId=e.billing[0].id))}}])}(shop),function(e){e.controller("AccountPageControllerVN",["$scope","$http","$timeout","$window","AddressService",function(e,t,i,s,d){e.guestOrderPageDisplaySettings.showOrderManageText=!1,e.orderHistoryPDF=!0,e.initAddressForms=function(){angular.isDefined(e.CHECKOUT_SHIPPING_ADDRESS)||(e.CHECKOUT_SHIPPING_ADDRESS={}),angular.isDefined(e.CHECKOUT_BILLING_ADDRESS)||(e.CHECKOUT_BILLING_ADDRESS={});var t=angular.element(document.getElementsByClassName("profile-address-form"));angular.forEach(t,function(t){var i=angular.element(t),s=i.attr("name"),d=i.attr("data-modelname");e.createWatchers(s,d)})},e.createWatchers=function(t,i){void 0!==e[i][t]&&(e[i][t].district_disabled=!0,e[i][t].ward_disabled=!0),e.$watch("".concat(i,".").concat(t,".regionIso"),function(s){void 0!==s&&""!==s&&d.getDistricts(s).then(function(s){angular.isArray(s)&&s.length&&(e[i][t].district_disabled=!1,e[i][t].district_items=d.districtsConverter(s))})}),e.$watch("".concat(i,".").concat(t,".district"),function(s){void 0!==s&&""!==s&&d.getWards(s).then(function(s){angular.isArray(s)&&s.length&&(e[i][t].ward_disabled=!1,e[i][t].ward_items=d.wardsConverter(s))})})},e.saveAddress=function(t,i,s,d){s?e.addAddress(t,i,s,d):e.editAddress(t,i,s,d)},e.addAddress=function(e,i){var a="".concat(ACC.utils.getBaseURL()+ACC.config.encodedContextPath,"/my-account/add-address"),n=$.param(d.getAddressFormData(e,i,"VN"));t.post(a,n,{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}}).then(function(){var e=[s.location.protocol,"//",s.location.host,s.location.pathname].join("");s.location.href="".concat(e,"?addAddress=true")})},e.editAddress=function(e,i,a,n){var o="".concat(ACC.utils.getBaseURL()+ACC.config.encodedContextPath,"/my-account/edit-address/").concat(n),r=$.param(d.getAddressFormData(e,i,"VN"));t.post(o,r,{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}}).then(function(){var e=[s.location.protocol,"//",s.location.host,s.location.pathname].join("");s.location.href="".concat(e,"?updateAddress=true")})}}])}(shop),function(e){e.controller("ConfirmationPageControllerVN",["$scope",function(e){e.savinaConfirmation=!1}])}(shop),shop.controller("myAccountWishlistControllerVN",["$scope","$timeout",function(e,t){var i=function(){var e=null;ACC.accessibility.config.focusModalCallerOnHide=!1,t(function(){$(".add-to-basket").on("click",function(){e=$(".add-to-basket").index(this)}),$(".js-continue-modal").on("click",function(i){i.preventDefault(),$(".add-container button:eq(".concat(e,")")).addClass("no-outline"),t(function(){$(".remove-product a:eq(".concat(e,")")).focus(),$(".add-container button:eq(".concat(e,")")).removeClass("no-outline")},500)})})};e.shiftFocus=!0,e.shiftFocusToFaq=function(){var e=".faq-banner-container-wrapper .faq-banner-container .faq-content .faq-link > a";ACC.global.smoothScroll(e,800),t(function(){$(e).focus()},1e3),i()},e.callbacks=function(){i()}}]),function(e){e.controller("smeRegistrationControllerVN",["$scope","AddressService",function(e,t){e.$watch("CUSTOMER_REGISTRATION_ADDRESS.regionIso",function(i){t.getDistricts(i).then(function(i){angular.isArray(i)&&i.length&&(e.CUSTOMER_REGISTRATION_ADDRESS.district_disabled=!1,e.CUSTOMER_REGISTRATION_ADDRESS.district_items=t.districtsConverter(i),void 0!==e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_district&&null!==e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_district&&(e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_district.$touched=!0))})}),e.$watch("CUSTOMER_REGISTRATION_ADDRESS.district",function(i){void 0!==i&&""!==i?t.getWards(i).then(function(i){angular.isArray(i)&&i.length&&(e.CUSTOMER_REGISTRATION_ADDRESS.ward_disabled=!1,e.CUSTOMER_REGISTRATION_ADDRESS.ward_items=t.wardsConverter(i),void 0!==e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_ward&&null!==e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_ward&&(e.CUSTOMER_REGISTRATION_ADDRESS.CUSTOMER_REGISTRATION_ADDRESS_ward.$touched=!0))}):(e.CUSTOMER_REGISTRATION_ADDRESS.ward="",e.CUSTOMER_REGISTRATION_ADDRESS.ward_items={})})}])}(shop),ACC.checkout={_autoload:["initPopover","bindCheckO",["bindForms",$(".toko-dynamic-form").length>0],"bindSavedPayments","bindDifferentAddress","bindDeliveryOptions","cleanCheckbox",["parcelPointInit",$(".toko-dynamic-form").length>0],["initDeliveryOptions",$(".toko-dynamic-form").length>0],"bindSSOLogin","bindGuestLogin","creditCardFieldListener","mandatoryListener","bindInitPaymentButton"],parcelPoint:null,_DEBUG:!1,isFormValidating:!1,continueButtonEnabled:!1,placeOrderNewCcButtonEnabled:!1,placeOrderSavedCcButtonEnabled:!1,lastSameBillingStateAtAddressTab:!0,setContinueButtonState:function(e){ACC.checkout.continueButtonEnabled=e,$("#deliveryOptionsSubmit").trigger("button.state.changed",[e])},validationCandidateGroup:["#shipping-header-detail","#shipping-address-detail","#billing-address-detail"],validationExemptedFields:["receiveSmsDelivery","shippingAddress.saveInAddressBook","billingAddress.saveInAddressBook","shipping-qas","billing-qas"],validationPaymentGroup:[],initPopover:function(){$('.cvv-area [data-toggle="popover"]').popover({html:!0,trigger:"hover focus",content:function(){return'<div class="text-center popover-return-content"><img src="'.concat($(this).data("img"),'" /> <br>').concat($(this).data("des"),"</div>")}})},validateForm:function(){ACC.checkout.isFormValidating=!0;var e=!0,t=$("#sameAddressBilling").is(":checked");Object.keys(ACC.checkout.validationCandidateGroup).forEach(function(i){var s=ACC.checkout.validationCandidateGroup[i];if("string"==typeof s)if("ship-to-store-fluent-retail"===$(".js-delivery-method-option.active a.js-delivery-option").data("optionId")){if("#shipping-address-detail"===s)return;$(s).find("input,select").each(function(){var t=ACC.checkout.validateFormFields(this),i="saved"===$("[name='billingAddress.addressDetailSwitch']:checked").val(),s="new"===$("[name='billingAddress.addressDetailSwitch']:checked").val();i?("billingAddress.addressId"===$(this).attr("name")&&(""!==$(this).val()&&null!==$(this).val()||(ACC.checkout._DEBUG,t=!1)),"billingAddress.firstName"!==$(this).attr("name")&&"billingAddress.lastName"!==$(this).attr("name")&&"billingAddress.line1"!==$(this).attr("name")&&"billingAddress.townCity"!==$(this).attr("name")&&"billingAddress.phone"!==$(this).attr("name")&&"billingAddress.postcode"!==$(this).attr("name")||($(this).attr("data-passed",!0),ACC.checkout._DEBUG,t=!0)):s&&"billingAddress.addressId"===$(this).attr("name")&&($(this).children("option").length>0&&(""===$(this).val()||null===$(this).val())?(ACC.checkout._DEBUG,t=!1):t=!0),t||(e=!1)})}else{if("#billing-address-detail"===s&&t)return;$(s).find("input,select").each(function(){var i=ACC.checkout.validateFormFields(this),s="saved"===$("[name='addressDetailSwitch']:checked").val(),d="new"===$("[name='addressDetailSwitch']:checked").val(),a="saved"===$("[name='billingAddress.addressDetailSwitch']:checked").val(),n="new"===$("[name='billingAddress.addressDetailSwitch']:checked").val();t?(s?("shippingAddress.line1"!==$(this).attr("name")&&"shippingAddress.line2"!==$(this).attr("name")&&"shippingAddress.townCity"!==$(this).attr("name")&&"shippingAddress.district"!==$(this).attr("name")&&"shippingAddress.postcode"!==$(this).attr("name")||($(this).attr("data-passed",!0),i=!0,ACC.checkout._DEBUG),"shippingAddress.addressId"===$(this).attr("name")&&($(this).children("option").length>0&&(""===$(this).val()||null===$(this).val())?(ACC.checkout._DEBUG,i=!1):i=!0)):d&&"shippingAddress.addressId"===$(this).attr("name")&&(ACC.checkout._DEBUG,i=!0),"billingAddress.firstName"!==$(this).attr("name")&&"billingAddress.lastName"!==$(this).attr("name")&&"billingAddress.line1"!==$(this).attr("name")&&"billingAddress.townCity"!==$(this).attr("name")&&"billingAddress.phone"!==$(this).attr("name")&&"billingAddress.postcode"!==$(this).attr("name")&&"billingAddress.addressId"!==$(this).attr("name")||($(this).attr("data-passed",!0),ACC.checkout._DEBUG,i=!0)):(s&&("shippingAddress.line1"!==$(this).attr("name")&&"shippingAddress.line2"!==$(this).attr("name")&&"shippingAddress.townCity"!==$(this).attr("name")&&"shippingAddress.district"!==$(this).attr("name")&&"shippingAddress.postcode"!==$(this).attr("name")||($(this).attr("data-passed",!0),i=!0,ACC.checkout._DEBUG),"shippingAddress.addressId"===$(this).attr("name")&&($(this).children("option").length>0&&(""===$(this).val()||null===$(this).val())?(ACC.checkout._DEBUG,i=!1):i=!0)),d&&"shippingAddress.addressId"===$(this).attr("name")&&(ACC.checkout._DEBUG,i=!0),a?("billingAddress.addressId"===$(this).attr("name")&&($(this).children("option").length>0&&(""===$(this).val()||null===$(this).val())?(ACC.checkout._DEBUG,i=!1):i=!0),"billingAddress.firstName"!==$(this).attr("name")&&"billingAddress.lastName"!==$(this).attr("name")&&"billingAddress.line1"!==$(this).attr("name")&&"billingAddress.line2"!==$(this).attr("name")&&"billingAddress.townCity"!==$(this).attr("name")&&"billingAddress.phone"!==$(this).attr("name")&&"billingAddress.district"!==$(this).attr("name")&&"billingAddress.postcode"!==$(this).attr("name")||($(this).attr("data-passed",!0),ACC.checkout._DEBUG,i=!0)):n&&"billingAddress.addressId"===$(this).attr("name")&&(ACC.checkout._DEBUG,i=!0)),i||(e=!1)})}}),"ship-to-store-fluent-retail"===activeTab.data("optionId")&&null===ACC.checkout.parcelPoint&&(e=!1),e?ACC.checkout.setContinueButtonState(!0):ACC.checkout.setContinueButtonState(!1),ACC.checkout._DEBUG,ACC.checkout.isFormValidating=!1},validateFormFields:function(e){var t=$(e);if(0===t.length)return!0;var i=t.data("required"),s=t.data("passed");return void 0!==s&&null!==s||(t.attr("data-passed",!1),s=!1),void 0!==i&&null!==s||(t.attr("data-required",!1),s=!1),!0===i&&ACC.global.isStringEmpty(t.val())?(t.attr("data-passed",!1),s=!1):(t.attr("data-passed",!0),s=!0),ACC.checkout._DEBUG,s},bindForms:function(){$(document).on("change keyup paste","input",function(e){ACC.checkout.validationExemptedFields.includes($(e.target).attr("name"))||ACC.checkout.validateForm()}),$("#deliveryOptionsSubmit").on("button.state.changed",function(e,t){$(this).prop("disabled",!t)}),ACC.checkout.validateForm(),$(document).on("click","#deliveryOptionsSubmit",function(e){e.preventDefault(),"undefined"!=typeof parcelPointData&&ACC.checkout.beforeSubmitFluentRetail(),$("#deliveryOptionsForm").submit()}),$(document).on("click","#deliveryMethodSubmit",function(e){e.preventDefault(),$("#selectDeliveryMethodForm").submit()})},bindSavedPayments:function(){$(document).on("click",".js-saved-payments",function(e){e.preventDefault();var t=$("#savedpaymentstitle").html();$.colorbox({href:"#savedpaymentsbody",inline:!0,maxWidth:"100%",opacity:.7,title:t,close:'<span class="glyphicon glyphicon-remove"></span>',onComplete:function(){}})})},bindCheckO:function(){$(".doFlowSelectedChange").change(function(){"multistep-pci"===$("#selectAltCheckoutFlow").attr("value")?$("#selectPciOption").css("display",""):$("#selectPciOption").css("display","none")}),$(".continueShoppingButton").click(function(){var e=$(this).data("continueShoppingUrl");window.location=e}),$(".expressCheckoutButton").click(function(){document.getElementById("expressCheckoutCheckbox").checked=!0}),$(document).on("input",".confirmGuestEmail,.guestEmail",function(){$(".guestEmail").val()===$(".confirmGuestEmail").val()?$(".guestCheckoutBtn").removeAttr("disabled"):$(".guestCheckoutBtn").attr("disabled","disabled")}),$(".checkoutButton").click(function(){var e=$(this).data("checkoutUrl");if(!ACC.pickupinstore.validatePickupinStoreCartEntires()){var t=$(".express-checkout-checkbox");if(t.is(":checked"))window.location=t.data("expressCheckoutUrl");else{var i=$("#selectAltCheckoutFlow").attr("value");if(void 0===i||""===i)window.location=e;else{"multistep-pci"===i&&(i="multistep");var s=$("#selectPciOption").attr("value"),d="".concat(e,"/select-flow?flow=").concat(i,"&pci=").concat(s);window.location=d}}}return!1})},bindDifferentAddress:function(){if($("#differentAddress").length&&($("#differentAddress").on("change",function(){if($("#differentAddress").is(":checked"))ACC.checkout.clearAddressForm(),ACC.checkout.enableAddressForm();else{var e={countryIsoCode:$("#useDeliveryAddressData").data("countryisocode"),differentAddress:!0};ACC.checkout.enableAddressForm(),ACC.checkout.displayCreditCardAddressForm(e,ACC.checkout.useDeliveryAddressSelected),ACC.checkout.disableAddressForm()}}),!$("#differentAddress").is(":checked"))){var e={countryIsoCode:$("#useDeliveryAddressData").data("countryisocode"),differentAddress:!0};ACC.checkout.enableAddressForm(),ACC.checkout.displayCreditCardAddressForm(e,ACC.checkout.useDeliveryAddressSelected),ACC.checkout.disableAddressForm()}},bindDeliveryOptions:function(){$(document).on("address:change",function(e,t){ACC.checkout.getDeliveryOptions(t)})},initDeliveryOptions:function(){var e=$(".checkout-delivery-method");ACC.checkout.validateDeliveryOptions(),ACC.checkout.refreshDeliveryOptions();var t=$("#saved-address-shipping");if("saved"===$("[name='addressDetailSwitch']:checked").val())t.children("option[value!='']").length<2&&t.val(t.children("option").first().val()),ACC.checkout.setDeliveryOptionsVisible(!0);else{var i=$("[name='shippingAddress.postcode']").val();ACC.checkout.setDeliveryOptionsVisible(!ACC.global.isStringEmpty(i))}var s="";if($("[name='deliveryMethod'] option").each(function(){"selected"===$(this).attr("selected")&&(s=$(this).val())}),""===s){var d=$("[name='deliveryMethod'] option:first-child");s=$(d).val()}ACC.checkout.setDeliveryMethod(s),e.find("[name='delivery-mode-code'][value='".concat(ACC.checkout.getDeliveryMethod(),"']")).prop("checked",!0),$(document).on("change",".js-delivery-option input[type='radio']",function(){$(document).trigger("deliveryoption:change",[$(this).val()])}),$(document).on("deliveryoption:change",function(e,t){ACC.checkout.validateDeliveryOptions(t),ACC.checkout.refreshDeliveryOptions()})},validateDeliveryOptions:function(e){var t=$(".js-delivery-methods-details"),i=$("[name='deliveryMethod']");void 0!==e&&(i.val(e),ACC.checkout.selectedDeliveryMode=e),i.length<1||i.children("option").length<1?t.hide():t.show(),"ship-to-store-fluent-retail"===$(".js-delivery-method-option.active a.js-delivery-option").data("optionId")&&t.hide()},refreshDeliveryOptions:function(){var e=$("[name='deliveryMethod']"),t=$(".js-delivery-methods .js-delivery-selection .js-delivery-option");if(ACC.global.isStringEmpty(ACC.checkout.selectedDeliveryMode)||(t.removeClass("active"),$("#".concat(ACC.checkout.selectedDeliveryMode)).addClass("active")),0!==$(".js-delivery-option.active").length)t.find('input[type="radio"]').prop("checked",!1),t.find('input[type="radio"][value="'.concat(ACC.checkout.selectedDeliveryMode,'"]')).prop("checked",!0);else if(t.find('input[type="radio"]').prop("checked",!1),ACC.global.isStringEmpty(ACC.checkout.selectedDeliveryMode))t.first().addClass("active"),t.first().find('input[type="radio"]').prop("checked",!0).addClass("active"),ACC.checkout.selectedDeliveryMode=t.first().find('input[type="radio"]').val();else{var i=t.find('input[type="radio"][value="'.concat(ACC.checkout.selectedDeliveryMode,'"]'));i.length&&(i.prop("checked",!0),i.addClass("active"),i.closest(".js-delivery-option").addClass("active"))}ACC.global.isStringEmpty(ACC.checkout.selectedDeliveryMode)||e.val(ACC.checkout.selectedDeliveryMode);var s=ACC.checkout.getDeliveryDetail(ACC.checkout.selectedDeliveryMode);void 0!==s&&null!=s&&s.length&&s.addClass("active")},selectedDeliveryMode:"",getDeliveryOptions:function(e,t){if(void 0!==e){var i=e.postalCode,s=_slicedToArray(e.region,1)[0],d=$(e.parent)||$(".search-address"),a=$(".js-delivery-method-selection .js-delivery-method-option.active a").data("tag");"GB"===s&&(s="UK"),a!==ACC.globalEnums.deliveryTabs.SHIPTOSTORE&&$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/delivery-address/getApplicableDeliveryMethods"),type:"POST",data:{postCode:i,country:s,addressId:""},beforeSend:function(){d.find(".ajax-loader").show(),ACC.checkout.setContinueButtonState(!1)},success:function(e){ACC.checkout.updateDeliveryDetails(e),void 0!==t&&t.call(this,e)},complete:function(){d.find(".ajax-loader").hide(),ACC.checkout.validateDeliveryOptions(),ACC.checkout.refreshDeliveryOptions(),ACC.checkout.validateForm()},error:function(){}})}},getDeliveryDetail:function(e){var t=$(".js-delivery-selection-details");return ACC.global.isStringEmpty(e)?[]:t.find("#".concat(e))},updateDeliveryDetails:function(e){var t=$(".checkout-delivery-method"),i=$("[name='deliveryMethod']");ACC.checkout.selectedDeliveryMode=ACC.checkout.getDeliveryMethod(),i.empty();var s=t.find(".js-delivery-selection");s.empty(),$(".js-delivery-selection-details").empty();var d,a="";Object.keys(e).forEach(function(t){var n=e[t];void 0!==n.deliveryCost&&("undefined"!=typeof parcelPointData?n.code!==parcelPointData.fluentRetailTargetName&&(d=ACC.checkout.deliveryOptionTabComposer(n)):(d=ACC.checkout.deliveryOptionTabComposer(n),i.append(d.option),s.append(d.a))),n.shipToStore?n.code===ACC.checkout.selectedDeliveryMode&&(ACC.checkout.selectedDeliveryMode=""):ACC.global.isStringEmpty(a)&&(a=n.code,ACC.checkout.selectedDeliveryMode=a)}),0!==i.children().length&&ACC.checkout.refreshDeliveryOptions(),ACC.checkout.validateForm()},deliveryOptionTabComposer:function(e){var t=$("<option />");t.attr("value",e.code),t.html(e.name);var i=$('<div class="delivery-option js-delivery-option clearfix"></div>'),s='<label for="'.concat(e.code,'"><input type="radio" name="delivery-mode-code" id="').concat(e.code,'" value="').concat(e.code,'" /></input><span class="description">').concat(e.name," (").concat(e.description,")</span><span class='cost pull-right'>").concat(e.deliveryCost.value>0?e.deliveryCost.formattedValue:"FREE","</span>");i.attr("data-option-id",e.code),i.html(s);var d=$('<div class="delivery-option-text"></div>'),a="<p>".concat(e.summary,"</p>"),n=$(".js-delivery-selection-details");return d.attr("id",e.code),d.html(a),n.append(d),{option:t,a:i,code:e.code,name:e.name,description:e.description,cost:e.deliveryCost}},enableAddressForm:function(){$('input[id^="address\\."]').prop("disabled",!1),$('select[id^="address\\."]').prop("disabled",!1)},displayCreditCardAddressForm:function(e,t){$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/payment-method/adyenbillingaddressform"),async:!0,data:e,dataType:"html"}).done(function(e){$("#billingAddressForm").html(e),"function"==typeof t&&t.call()})},useDeliveryAddressSelected:function(){$("#differentAddress").is(":checked")?(ACC.checkout.clearAddressForm(),ACC.checkout.enableAddressForm()):($("#address\\.country").val($("#useDeliveryAddressData").data("countryisocode")),ACC.checkout.disableAddressForm())},disableAddressForm:function(){$('input[id^="address\\."]').prop("disabled",!0),$('select[id^="address\\."]').prop("disabled",!0)},clearAddressForm:function(){$('input[id^="address\\."]').val(""),$('select[id^="address\\."]').val("")},cleanCheckbox:function(){$(".checkbox").each(function(){var e=$(this).find('input[type="checkbox"].checkbox-input').attr("name"),t=$(this).find('input[name="_'.concat(e,'"]')),i=$(this).find(".checkbox-label");t.length&&t.insertAfter(i)})},parcelPointInit:function(){if($("#parcelPointDiv").length>0&&parcelPointData.supported){ACC.isFluentRetailSupported=!0,ACC.checkout.deliveryMethodTabListener();!function e(){jQuery.getScript(parcelPointData.widgetUrl,function(){ACC.checkout.parcelPoint=ACC.checkout.loadParcelPoint(),$("#saved-address-billing").change(),ACC.checkout.validateForm()}).fail(function(){window.setTimeout(e,3e3)})}()}},loadParcelPoint:function(){var e=""===parcelPointData.postcode?ACC.checkout.defineGeolocation():parcelPointData.postcode,t={apiKey:parcelPointData.apiKey,initialAddress:e,targetDiv:"parcelPointDiv",storeType:"full",selectFirstStore:!!ACC.global.isStringEmpty(parcelPointData.selectedStoreId),storeExternalId:parcelPointData.selectedStoreId,initialView:ACC.checkout.detectParcelPointView(),extendedCSS:parcelPointData.cssFile,timeLimit:20,messages:{paginationLeft:"PREV",paginationRight:"NEXT"},networkOptions:{SSNG_STORES:{name:"Samsung Stores",markerIcons:{store:{normalIcon:parcelPointData.samsungIcon,activeIcon:parcelPointData.samsungIconActive}}},SSNG_PARCELPOINT:{name:"ParcelPoint Stores",markerIcons:{store:{normalIcon:parcelPointData.locationIcon,activeIcon:parcelPointData.locationIconActive}}}}};parcelpoint.Store.init(t),parcelpoint.Store.display(t),ACC.checkout.eventListenFluentRetail();var i=$('.js-delivery-method-option a[href="#clickCollectDelivery"]');return i.data("active")&&i.click(),parcelpoint.Property.onChange(["storeDetails"],function(){"ship-to-store-fluent-retail"===$(".js-delivery-method-option.active a.js-delivery-option").data("optionId")&&ACC.checkout.validateForm()}),parcelpoint},detectParcelPointView:function(){return $(window).width()>=1024?"map":"list"},eventListenFluentRetail:function(){var e='.js-delivery-option[data-option-id="'.concat(parcelPointData.fluentRetailTargetName,'"]'),t=$('[name="shippingAddress.billingAddress"]');$(".js-checkout-shipping-details").on("click",e,function(e){e.preventDefault(),$(".js-parcel-point-wrapper").addClass("active"),t.prop("checked",!1),t.trigger("change"),t.prop("disabled",!0)})},defineGeolocation:function(){$("#ppIframeWidget-parcelPointDiv").contents().contents().find(".geolocation-button").delay(2e3).click()},isFluentRetailSupported:!1,isFluentRetailDeliveryMode:function(e){return!("undefined"===parcelPointData||null===parcelPointData||!parcelPointData.supported)&&e.code===parcelPointData.fluentRetailTargetName},beforeSubmitFluentRetail:function(){var e=ACC.checkout.getDeliveryMethod();if("saved"===$("[name='addressDetailSwitch']:checked").val()&&e!==parcelPointData.fluentRetailTargetName){var t=$("#saved-address-shipping option:selected").data("raw");return $("input[name='shippingAddress.countryIso']").prop("disabled",!1),$("input[name='shippingAddress.line1']").val(t.line1),$("input[name='shippingAddress.line2']").val(t.line2),$("input[name='shippingAddress.townCity']").val(t.town),$("select[name='shippingAddress.regionIso']").val("".concat(t.countryIso,"-").concat(t.region.isocode)),$("input[name='shippingAddress.postcode']").val(t.storePostCode),$("input[name='shippingAddress.countryIso']").val(t.countryIso),!0}if(ACC.isFluentRetailSupported&&e===parcelPointData.fluentRetailTargetName){var i=parcelpoint.Property.storeDetails();if(void 0!==i||null!=i){ACC.checkout.enableAddressForm();var s="GB"===i.storeCountry?"UK":"";$("input[name='shippingAddress.countryIso']").prop("disabled",!1),$("input[name='shippingAddress.shipToStoreId']").val(i.storeId),$("input[name='shippingAddress.line1']").val(i.storeAddress1),$("input[name='shippingAddress.line2']").val(i.storeAddress2),$("input[name='shippingAddress.townCity']").val(i.storeCity),$("select[name='shippingAddress.regionIso']").val("".concat(s,"-").concat(i.storeState)),$("input[name='shippingAddress.postcode']").val(i.storePostCode),$("input[name='shippingAddress.countryIso']").val(s)}}return null},deliveryMethodTabListener:function(){ACC.checkout.toggleAddressFluentRetail($("li.active a.js-delivery-option"),!1),$('a[data-toggle="tab"].js-delivery-option').on("shown.bs.tab",function(){$(".js-delivery-methods-details").hide(),"ship-to-store-fluent-retail"===$(this).data("option-id")?($(".js-billing-address-checkbox-wrapper").hide(),ACC.address.toggleAddressFields($("#shipping-address-detail").find(".js-new-detail input"),!0),ACC.global.isStringEmpty($("[name='billingAddress.line1']").val())?$(".billing-address-fields").hide():$(".billing-address-fields").show(),ACC.checkout.toggleAddressFluentRetail(this,!0),$('[name="shippingAddress.billingAddress"]').prop("checked",!1),$(document).trigger("deliveryoption:change",[$(this).data("option-id")]),$('[name="bllingAddress.addressDetailSwitch"]:checked').change(),$(".js-delivery-methods-details").hide()):($(".js-billing-address-checkbox-wrapper").show(),ACC.address.toggleAddressFields($("#shipping-address-detail").find(".js-new-detail input"),!1),$('[name="shippingAddress.billingAddress"]').prop("disabled",!1),ACC.global.isStringEmpty($("[name='shippingAddress.line1']").val())?$(".shipping-address-fields").hide():$(".shipping-address-fields").show(),$('[name="shippingAddress.billingAddress"]').prop("checked",!0),ACC.global.isStringEmpty($("[name='billingAddress.line1']").val())?$(".billing-address-fields").hide():($('[name="shippingAddress.billingAddress"]').prop("checked",!1),$(".billing-address-fields").show()),$(document).trigger("deliveryoption:change",[$(this).data("option-id")]),$('[name="addressDetailSwitch"]:checked').change()),$('[name="shippingAddress.billingAddress"]').change(),ACC.checkout.validateForm()})},toggleAddressFluentRetail:function(e,t){var i=$(e).data("optionId"),s=!0;(parcelPointData.fluentRetailTargetName===i?(ACC.checkout.setDeliveryMethod(i),s=!1,$(".js-parcel-point-wrapper").addClass("active"),$(".js-billing-address-checkbox-wrapper").hide(),$(".js-delivery-methods-details").hide()):t&&(i=$('[name="delivery-mode-code"]:checked').val(),$(".js-parcel-point-wrapper").removeClass("active"),$(".js-billing-address-detail").hide(),ACC.checkout.setDeliveryMethod(i)),s)&&(s=$(".checkout-delivery-method").find(".js-delivery-option").length>1);ACC.checkout.setDeliveryOptionsVisible(s)},setDeliveryMethod:function(e){$(".checkout-delivery-method").find("[name='deliveryMethod']").val(e)},getDeliveryMethod:function(){return $(".checkout-delivery-method").find("[name='deliveryMethod']").val()},setDeliveryOptionsVisible:function(e){var t=$(".js-delivery-methods-details");e?t.show():t.hide()},validateSSOFormInputs:function(){var e=$("#svcIptLgnID").val(),t=$("#svcIptLgnPD").val(),i=ACC.checkout.isEmpty(e)||ACC.checkout.isEmpty(t);return $(".tokosso-submit-btn").prop("disabled",i),!i},isEmpty:function(e){return void 0===e||null==e||!e},bindSSOLogin:function(){$(document).on("change keyup paste","#svcIptLgnID , #svcIptLgnPD",function(){ACC.checkout.validateSSOFormInputs()}),$(document).on("click",".tokosso-submit-btn",function(e){e.preventDefault(),ACC.checkout.validateSSOFormInputs()&&(JSON.parse(ACC.config.ssov2)&&"get"===$("#tokossoform").attr("method")?window.location.href=$("#tokossoform").attr("action"):$("#tokossoform").submit())})},bindSSOSignup:function(){$(document).on("click",".sso-account-create-link",function(e){e.preventDefault(),JSON.parse(ACC.config.ssov2)&&"get"===$("#tokossoguestform").attr("method")?window.location.href=$("#tokossoguestform").attr("action"):$("#tokossoguestform").submit()})},validateGuestFormInputs:function(){var e=$('#guestForm input[name="email"]').val(),t=ACC.checkout.isEmpty(e);return $("#tokoguest-submit-btn").prop("disabled",t),!t},bindGuestLogin:function(){$("#tokoguest-submit-btn").on("click",function(){ACC.netfunnel.action({action_id:ACC.netfunnel.actionIds.shipment},function(){$("#guestForm").submit()})}),$(document).on("blur change keyup paste","#email",function(){ACC.checkout.validateGuestFormInputs()}),$(document).on("mousemove",".account-login-grid",function(){ACC.checkout.validateGuestFormInputs()}),$(document).on("click",".tokosso-submit-btn",function(e){e.preventDefault(),ACC.checkout.validateSSOFormInputs()&&(JSON.parse(ACC.config.ssov2)&&"get"===$("#tokossoform").attr("method")?window.location.href=$("#tokossoform").attr("action"):$("#tokossoform").submit())})},creditCardFieldListener:function(){$(".js-cardNumber").blur(function(){var e=$(this).val();e=e.match(/.{1,4}/g).join(" "),$(this).val(e)}).focus(function(){var e=$(this).val();e=e.replace(/\s/g,""),$(this).val(e)}).keydown(function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()})},mandatoryListener:function(){$(".js-checkout-shipping-details input[type='text']").focusout(function(){$(this).data("required")&&0===$(this).val().trim().length?$(this).addClass("error-mandatory"):$(this).removeClass("error-mandatory")})},bindInitPaymentButton:function(){$("#submitPaymentDetailsBtn").prop("disabled",!ACC.checkout.placeOrderNewCcButtonEnabled),$("#submitSavedCardDetailsBtn").prop("disabled",!ACC.checkout.placeOrderSavedCcButtonEnabled),$(document).on("change keyup","#savedCardCheckTermsCondition",function(){$("#submitSavedCardDetailsBtn").prop("disabled",!$(this).prop("checked"))})}};var vnAccount={_autoload:[["init",$("table.quota-table").length>0],["qasBindSearch",$(".qas-profile .search-address").length>0],["orderHistoryShowAllProducts",$(".js--order-history--show-all").length>0],["eppRegistrationFormSubmit",$("#eppRegistrationForm").length>0||$("#link-to-store-success").length>0]],orderHistoryShowAllProducts:function(){$(".js--order-history--show-all").on("click",function(e){e.preventDefault(),$(this).prev(".orderhistory-list-table").find(".responsive-table-item--hidden").removeClass("responsive-table-item--hidden"),$(this).remove()})},qasBindSearch:function(){$(".qas-profile .search-address").each(function(){var e=$(this).data("token"),t=$(this).sagify({placeholder:ACC.qasInputPlaceholder,noSuggestionText:ACC.qasNoAddressText,minimumChars:3,forceNoSuggestionTextAsFirstItem:!0,maxDropDownItemsVisible:8}),i=ACC.poBoxFpoMessageRegex;$(this).on("sagify:textchange",function(e,s,d){var a;ACC.account.qasFetchSearchData(t,$(s),function(e,s,n){if(null!==n?n===ACC.qasTooManyMatches||"Too many results found"===n?t.settings.noSuggestionText=ACC.qasTooManyMatches:!0===i.test(d)?t.settings.noSuggestionText=ACC.qasPoBoxFpoMessage:t.settings.noSuggestionText=ACC.qasNoAddressText:t.settings.noSuggestionText=ACC.qasNoAddressText,0===e.length||t.settings.forceNoSuggestionTextAsFirstItem){a=t.settings.noSuggestionText===ACC.qasPoBoxFpoMessage?t.createDropDownItemObject("",t.settings.noSuggestionText,t.noResultId,t.noResultId,""):t.createDropDownItemObject("",t.settings.noSuggestionText,t.noResultId,t.noResultId,ACC.clickToEnterAddress);var o=e;(o=e||[]).splice(0,0,a),t.dropDown.empty(),t.dropDownItems=o,t.populateList(o),t.renderDropDown(),t.initDropDownEvents()}else t.updateDropDown(e);try{grunticon.embedIcons(grunticon.getIcons(grunticon.getCSS(grunticon.href)))}catch(e){}})}),$(this).on("sagify:selecteditem",function(i,s){return $(this).closest(".address-form").find(".address-fields").show(),"no-result"!==s&&(ACC.account.qasSearchSelection(t,s,e,t.input,function(e,t){}),null)})})},qasFetchSearchData:function(e,t,i){var s=t.closest(".search-address");$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/delivery-address/searchAddress"),data:{searchTerm:t.val()},dataType:"json",type:"GET",async:!0,beforeSend:function(){s.find(".ajax-loader").show(),ACC.global.removeFormFieldError(t)},success:function(e){var s=[];Object.keys(e.searchAddresses).forEach(function(i){var d=e.searchAddresses[i],a=ACC.account.qasHighlightSearch(t.val(),d.partialAddress);a="".concat(a," <span class='desc-color'>").concat(d.description,"</span>");var n={id:d.moniker,value:d.partialAddress,text:a,icon:"icon-qaspin",cssClass:""};s.push(n)}),"function"==typeof i&&i.call(this,s,!0,e.errorMsg)},complete:function(){s.find(".ajax-loader").hide()},error:function(e){"function"==typeof i&&i.call(this,[],!1),e.status}})},qasSearchSelection:function(e,t,i,s,d){if(void 0!==t&&""!==t){var a=s.closest(".address-search").siblings(".address-fields"),n=s.closest(".search-address");$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/delivery-address/getAddress"),data:{moniker:t},dataType:"json",type:"GET",beforeSend:function(){n.find(".ajax-loader").show(),ACC.global.removeFormFieldError(s)},success:function(e){ACC.address.populateAddressField(a,i,"fc-address",e.line1),ACC.address.populateAddressField(a,i,"fc-address-secondary",e.line2),ACC.address.populateAddressField(a,i,"fc-city",e.town),ACC.address.populateAddressField(a,i,"fc-district",e.district),ACC.address.populateAddressField(a,i,"fc-postcode",e.postalCode),ACC.address.populateAddressField(a,i,"fc-companyName",e.companyName),e.parent=a.find(".search-address"),"function"==typeof d&&d.call(this,e,!0)},complete:function(){n.find(".ajax-loader").hide()},error:function(e){"function"==typeof d&&d.call(this,{parent:a.find(".search-address")},!1),e.status}})}},qasHighlightSearch:function(e,t){var i="",s="",d=e.toString().replace(/[\\\^\$\*\+\?\.\(\)\|\{}\[\]]/g,"\\$&");"ig".indexOf("^")>=0&&(i="^"),"ig".indexOf("$")>=0&&(s="$");var a=new RegExp(i+d+s,"ig".replace(/[\$\^]/g,""));return t.replace(a,"<span class='highlight'>$&</span>")},eppRegistrationFormSubmit:function(){$("#eppRegistrationForm").ajaxForm({success:function(e){!0===e?($("#registartionSuccessDiv").show(),$("#registartionFormDiv").hide()):!1===$(".form-group").hasClass("has-error")&&$(".form-group").addClass("has-error")},error:function(){!1===$(".form-group").hasClass("has-error")&&$(".form-group").addClass("has-error")}}),!0===ACC.currentStoreMultiStore&&!0===ACC.multistoreVerificationSuccess&&$("#link-to-store-success").modal()}};window.ACC.account=ACC.account||{},ACC.account=_mergeThemeToBase(window.ACC.account,vnAccount,"account");var vnAddress={_autoload:[["init",$(".delete-payment-details").length>0],["bindAddressDetailsSwitch",$(".address-detail-block").length>0],["bindAddressFormActions",$(".saved-addresses-select").length>0],["qasBindSearch",$("#deliveryOptionsForm").length>0],["setAsDefault",$(".address_setDefault").length>0],["addNewProfileAddress",$(".address-form").length>0],["editProfileAddress",$(".address-section").length>0],["mandatoryListener",$(".js-profile-add-new-address").length>0],["showRemoveAddressFromBookConfirmation",$(".removeAddressFromBookButton").length>0]],init:function(){"undefined"!=typeof serviceId&&""===serviceId&&$(".address-fields").show(),$(document).on("click",".delete-payment-details",function(e){e.preventDefault();var t=$(this).data("paymentId"),i="#popup_confirm_payment_removal_".concat(t);$(i).modal()})},spinner:$("<img src='".concat(ACC.config.commonResourcePath,"/images/spinner.gif' />")),addressID:"",clearFormValues:function(e){e.find(".form-group").each(function(e,t){$(t).removeClass("has-error").find("input").val("")})},getAddressFormData:function(e){var t={};return t.shippingAddress=e.find('[name="fc-s-shipping-address"]').val(),t.billingAddress=e.find('[name="fc-s-billing-address"]').val(),t.defaultAddress=e.find('[name="isDefaultAddress"]').val(),t.titleCode=e.find(".fc-title-code").val(),t.fullName=e.find(".fc-full-name").val(),t.phone=e.find(".fc-phone1").val(),t.phoneNumber2=e.find(".fc-phone2").val(),t.line1=e.find(".fc-line1").val(),t.line2=e.find(".fc-line2").val(),t.regionIso=e.find(".fc-region-iso").val(),t.district=e.find(".fc-district").val(),t.ward=e.find(".fc-ward").val(),t.village=e.find(".fc-village").val(),t.companyTaxNumber=e.find(".fc-company-tax").val(),t.saveInAddressBook=!0,t.countryIso="VN","edit"===e.data("status")?t.editAddress=!0:t.editAddress=!1,t.isAjax=!0,e.data("id")&&""!==e.data("id")&&(t.addressId=e.data("id")),t},addNewProfileAddress:function(){$(".address-form").hide(),$(".address-section").each(function(){var e=$(this),t=$(this).find(".display-control");if(e.find(".address-block").each(function(e){e>=2&&$(this).addClass("address-block-hidden")}),t.length){var i=t.find(".show-all"),s=t.find(".show-less");s.hide(),i.on("click",function(t){t.preventDefault(),e.find(".address-block-hidden").fadeIn(800),s.show(),i.hide()}),s.on("click",function(t){t.preventDefault(),e.find(".address-block-hidden").fadeOut(800),i.show(),s.hide()})}}),$(".account-profile-section.address-section").each(function(){var e=$(this),t=e.find('.sub-header-action[href="add-address"]'),i=e.find(".js-profile-edit-address"),s=i.closest(".address-form"),d=e.find(".js-cancel-address");t.length>0&&t.on("click",function(e){var a;e.preventDefault(),i.addClass("hidden"),s.fadeOut("slow");var n=(a="shipping"===$(this).data("type")?$(".js-profile-add-new-address"):$(".js-profile-add-new-billing-address")).closest(".address-form");a.removeClass("hidden"),n.fadeIn("slow",function(){t.addClass("selected"),ACC.global.smoothScroll(a)}),d.on("click keyup",function(e){"click"!==e.type&&13!==e.keyCode||(e.preventDefault(),n.fadeOut("slow",function(){t.removeClass("selected"),ACC.global.smoothScroll(t)}))})})})},editProfileAddress:function(){$(".address-section").each(function(){$(".account-section-address-list .address-block").each(function(){var e=Date.now();$(this).find("form").attr("data-cache-id",e),ACC.address.cacheFormData(["fc-s-first-name","fc-s-last-name","fc-s-address","fc-s-city","fc-s-postcode","fc-s-mobile-number","fc-s-district"],e)})}),$(".js-profile-edit-address").length>0&&$(".account-section-address-list").on("click",".edit-address",function(e){e.preventDefault();var t=$(this),i=$(this).closest(".address-block").find(".address-form .js-profile-edit-address"),s=$(this).closest(".address-block").find(".address-form");i.removeClass("hidden"),s.fadeIn("slow",function(){ACC.global.smoothScroll(i)}),ACC.address.clearFormValues($(".add-new-address")),$(".add-new-address").addClass("hidden"),i.on("click",".js-cancel-address",function(e){e.preventDefault(),s.fadeOut("slow",function(){ACC.global.smoothScroll(t)}),i.off("click")})})},cacheFormData:function(e,t){window._savedFormData=window._savedFormData||{},window._savedFormData[t]={};var i=$('[data-cache-id="'.concat(t,'"]'));$.each(e,function(e,s){var d=i.find('[name="'.concat(s,'"]'));window._savedFormData[t][s]=d.val()})},loadCachedFormData:function(e,t){var i=$('[data-cache-id="'.concat(t,'"]'));$.each(e,function(e,s){i.find('[name="'.concat(s,'"]')).val(window._savedFormData[t][s])})},qasBindSearch:function(){$("#deliveryOptionsForm .search-address").each(function(){var e=$(this),t=e.data("token"),i=e.closest(".address-search").siblings(".address-fields"),s=$(this).sagify({placeholder:ACC.qasInputPlaceholder,noSuggestionText:ACC.qasNoAddressText,minimumChars:3,forceNoSuggestionTextAsFirstItem:!0,maxDropDownItemsVisible:8}),d=ACC.poBoxFpoMessageRegex;$(this).on("sagify:textchange",function(e,t,a){e.preventDefault(),ACC.address.qasFetchSearchData(s,$(t),function(e,t,n){i.is(":visible")&&i.fadeOut(),null!==n?n===ACC.qasTooManyMatches||"Too many results found"===n?s.settings.noSuggestionText=ACC.qasTooManyMatches:!0===d.test(a)?s.settings.noSuggestionText=ACC.qasPoBoxFpoMessage:s.settings.noSuggestionText=ACC.qasNoAddressText:s.settings.noSuggestionText=ACC.qasNoAddressText,s.updateDropDown(e);try{grunticon.embedIcons(grunticon.getIcons(grunticon.getCSS(grunticon.href)))}catch(e){}})}),$(this).on("sagify:selecteditem",function(e,d){"no-result"!==d?ACC.address.qasSearchSelection(s,d,t,s.input,function(e,t){t?(i.show(),$(i).hasClass("billing-address-fields")||$(document).trigger("address:change",[e]),ACC.checkout.validateForm()):i.hide()}):i.fadeIn()})})},qasFetchSearchData:function(e,t,i){var s=t.closest(".search-address");$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/delivery-address/searchAddress"),data:{searchTerm:t.val()},dataType:"json",type:"GET",async:!0,beforeSend:function(){s.find(".ajax-loader").show(),ACC.global.removeFormFieldError(t)},success:function(e){var t=[];Object.keys(e.searchAddresses).forEach(function(i){var s=e.searchAddresses[i],d={id:s.moniker,value:s.partialAddress,text:s.partialAddress,icon:"icon-qaspin",cssClass:""};t.push(d)}),"function"==typeof i&&i.call(this,t,!0,e.errorMsg)},complete:function(){s.find(".ajax-loader").hide()},error:function(e){"function"==typeof i&&i.call(this,[],!1),e.status}})},qasSearchSelection:function(e,t,i,s,d){if(void 0!==t&&""!==t){var a=s.closest(".address-detail-block"),n=s.closest(".search-address");$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/delivery-address/getAddress"),data:{moniker:t},dataType:"json",type:"GET",beforeSend:function(){n.find(".ajax-loader").show(),ACC.global.removeFormFieldError(s)},success:function(e){var t=e.region,s=t.countryIso,n=t.isocode;ACC.address.populateAddressField(a,i,"line1",e.line1),ACC.address.populateAddressField(a,i,"line2",e.line2),ACC.address.populateAddressField(a,i,"townCity",e.town),ACC.address.populateAddressField(a,i,"regionIso","".concat(s,"-").concat(n)),ACC.address.populateAddressField(a,i,"postcode",e.postalCode),ACC.address.populateAddressField(a,i,"district",e.district),e.parent=a.find(".search-address"),"function"==typeof d&&d.call(this,e,!0)},complete:function(){n.find(".ajax-loader").hide()},error:function(e){"function"==typeof d&&d.call(this,{parent:a.find(".search-address")},!1),e.status}})}},addressFormHasErrors:!1,isNewShippingAddressSelected:!1,populateAddressField:function(e,t,i,s){var d=t;""!==d&&(d+=".");var a='[name="'.concat(t).concat(i,'"]');e.find(a).val(s)},bindAddressDetailsSwitch:function(){function e(e,t){e?$(t).hide():$(t).show()}ACC.address.addressFormHasErrors=Boolean($("#deliveryOptionsForm").data("contains-error")),ACC.address.isNewShippingAddressSelected=Boolean($("#deliveryOptionsForm").data("new-shipping-address")),ACC.address.isNewBillingAddressSelected=Boolean($("#deliveryOptionsForm").data("new-billing-address")),ACC.address.showBillingDetails=Boolean($("#deliveryOptionsForm").data("show-billing-details")),ACC.address.showShippingDetails=Boolean($("#deliveryOptionsForm").data("show-shipping-details")),$(".address-detail-block").each(function(){var t="#".concat($(this).attr("id")),i=$(t).data("toggle"),s=$(t).data("isGuest"),d=Boolean($(t).find("select.has-address").length);if(void 0!==i){var a=$("input[name='".concat(i,"']"));e(a.is(":checked"),t),a.on("change",function(){e($(this).is(":checked"),t)})}ACC.checkout.initDeliveryOptions(),!0===s?($(this).find('input[type="radio"][value="saved"]').prop("disabled",!0),$(this).find('input[type="radio"][value="saved"]').prop("checked",!1),$(this).find('input[type="radio"][value="new"]').prop("checked",!0),ACC.address.addressDetailSwitch(t,$(t).find(".address-detail-switch input[type='radio'][value='new']"))):$(this).find('input[type="radio"][value="new"]').is(":checked")||!1===d?($(this).find('input[type="radio"][value="saved"]').prop("checked",!1),$(this).find('input[type="radio"][value="new"]').prop("checked",!0),ACC.address.addressDetailSwitch(t,$(t).find(".address-detail-switch input[type='radio'][value='new']"))):$('input[type="radio"][value="saved"]').is(":checked")&&!0===d&&($(this).find('input[type="radio"][value="saved"]').prop("disabled",!1),ACC.address.addressDetailSwitch(t,$(t).find(".address-detail-switch input[type='radio'][value='saved']"))),!1===d?$(this).find('input[type="radio"][value="saved"]').prop("disabled",!0):$(this).find('input[type="radio"][value="saved"]').prop("disabled",!1),"#billing-address-detail"===t&&ACC.address.showBillingDetails?$(this).find(".address-fields").show():"#shipping-address-detail"===t&&ACC.address.showShippingDetails&&$(this).find(".address-fields").show(),$(document).on("change","".concat(t," .address-detail-switch input[type='radio']"),function(){var e=$(this);ACC.address.addressDetailSwitch(t,e),$(t).find(".js-new-detail").find("input[type='text']").val(""),$(t).find(".js-new-detail .address-fields").hide()})})},addressDetailSwitch:function(e,t){"saved"===t.val()?($(e).find(".js-saved-detail").show(),$(e).find(".js-new-detail").hide(),ACC.address.toggleAddressFields($(e).find(".js-saved-detail input, .js-saved-detail select"),!1),ACC.address.toggleAddressFields($(e).find(".js-new-detail input"),!0),$(e).find(".save-details-flag").hide(),ACC.address.toggleAddressFields($(e).find(".save-details-flag input"),!0),$(e).find("#saved-address-shipping").length?$("#saved-address-shipping").change():$(e).find("#saved-address-billing").length&&$("#saved-address-billing").change()):"new"===t.val()&&($(e).find(".js-saved-detail").hide(),$(e).find(".js-new-detail").show(),"undefined"!=typeof serviceId&&""===serviceId?$(e).find(".js-new-detail").find(".address-fields").show():$(e).find(".js-new-detail").find(".address-fields").hide(),ACC.address.toggleAddressFields($(e).find(".js-saved-detail input,.js-saved-detail select"),!0),ACC.address.toggleAddressFields($(e).find(".js-new-detail input"),!1),"ship-to-store-fluent-retail"!==$(this).data("option-id")&&(ACC.global.isStringEmpty($("[name='shippingAddress.line1']").val())&&$(".js-delivery-methods-details").hide(),ACC.global.isStringEmpty($("[name='billingAddress.line1']").val())||$(".billing-address-fields").show()),$(e).find(".save-details-flag").show(),ACC.address.toggleAddressFields($(e).find(".save-details-flag input"),!1))},toggleAddressFields:function(e,t){e.each(function(){$(this).prop("disabled",t)})},isSameAsAddressBilling:!0,clearAddressFields:function(e){$(e).find('input[type="text"]').each(function(){$(this).val("")}),$(e).find("select").each(function(){$(this).val("")})},selectedSavedShippingAddressId:null,selectedSavedBillingAddressId:null,bindAddressFormActions:function(){ACC.address.selectedSavedShippingAddressId=$("#saved-address-shipping").val(),ACC.address.selectedSavedBillingAddressId=$("#saved-address-billing").val(),ACC.address.selectedSavedShippingAddressId===ACC.address.selectedSavedBillingAddressId&&($("#billing-address-detail").find('[name="billingAddress.addressDetailSwitch"][value="saved"]').prop("checked",!1),$("#billing-address-detail").find('[name="billingAddress.addressDetailSwitch"][value="new"]').prop("checked",!0).change()),$(document).on("change",".saved-addresses-select",function(){"saved-address-shipping"===$(this).get(0).id?ACC.address.selectedSavedShippingAddressId=$(this).val():"saved-address-billing"===$(this).get(0).id&&(ACC.address.selectedSavedBillingAddressId=$(this).val());var e=$($(this).data("infoBox")),t=$(this).find("option[value='".concat($(this).val(),"']")),i=t.data("raw");if(void 0!==i&&t.length){if(ACC.address.populateAddressDisplayInfo(e,i),"#shipping-saved-address-info"===$(this).data("info-box")){var s="true"===i.sameAsShippingAddress;$("#sameAddressBilling").is(":checked")!==s&&($("#sameAddressBilling").prop("checked",s),$("#sameAddressBilling").change())}if("saved-address-shipping"===$(this).get(0).id)ACC.checkout.getDeliveryOptions({postalCode:i.postCode,region:{countryIso:i.countryIso},parent:".js-delivery-methods-details"},function(){ACC.checkout.initDeliveryOptions()});else if("billingAddress.addressId"===$(this).attr("name")){var d={countryIso:i.countryIso,isocode:i.region.isocode},a="GB"===d.countryIso?"UK":d.countryIso,n=d.isocode,o="billingAddress",r=$("#billing-address-detail");ACC.address.populateAddressField(r,o,"firstName",i.firstName),ACC.address.populateAddressField(r,o,"lastName",i.lastName),ACC.address.populateAddressField(r,o,"phone",i.phone),ACC.address.populateAddressField(r,o,"line1",i.line1),ACC.address.populateAddressField(r,o,"line2",i.line2),ACC.address.populateAddressField(r,o,"townCity",i.town),ACC.address.populateAddressField(r,o,"district",response.district),ACC.address.populateAddressField(r,o,"regionIso","".concat(a,"-").concat(n)),ACC.address.populateAddressField(r,o,"postcode",i.postCode),ACC.checkout.validateForm()}}}),$(".saved-addresses-select").each(function(){var e=$($(this).data("infoBox")),t=$(this).find("option[value='".concat($(this).val(),"']")).data("raw");void 0!==t&&ACC.address.populateAddressDisplayInfo(e,t)}),$(document).on("change","#sameAddressBilling",function(){ACC.address.isSameAsAddressBilling=$(this).is(":checked")}),$(document).on("change keyup","[name='shippingAddress.postcode']",function(){var e={postalCode:$("[name='shippingAddress.postcode']").val(),region:{countryIso:$("[name='shippingAddress.countryIso']").val()}};!0===ACC.address.isSameAsAddressBilling&&$(document).trigger("address:change",[e])})},populateAddressDisplayInfo:function(e,t){if(void 0!==t&&null!==t){var i=e;ACC.global.isStringEmpty(t.line1)||i.find(".display-address1").text(t.line1),ACC.global.isStringEmpty(t.line2)||i.find(".display-address1").append(", ".concat(t.line2)),ACC.global.isStringEmpty(t.town)||i.find(".display-address1").append(", ".concat(t.town)),ACC.global.isStringEmpty(t.region.name)||i.find(".display-region").text(t.region.name),ACC.global.isStringEmpty(t.postCode)||i.find(".display-region").append(", ".concat(t.postCode)),ACC.global.isStringEmpty(t.country.name)||i.find(".display-region").append(" ".concat(t.country.name)),ACC.global.isStringEmpty(t.phone)||i.find(".display-mobile").text(t.phone)}},setDeliveryAddress:function(e,t){ACC.global.isStringEmpty(e)||$.ajax({type:"POST",url:"/checkout/multi/delivery-address/setDeliveryAddress",dataType:"json",data:{id:e},success:function(e){"function"==typeof t&&t.call(this,e,!0)},error:function(e){"function"==typeof t&&t.call(this,e,!1)}})},displayCountrySpecificAddressForm:function(e,t){$.ajax({url:"".concat(ACC.config.encodedContextPath,"/my-account/addressform"),async:!0,data:e,dataType:"html",beforeSend:function(){$("#i18nAddressForm").html(ACC.address.spinner)}}).done(function(e){$("#i18nAddressForm").html($(e).html()),"function"==typeof t&&t.call()})},mandatoryListener:function(){$(".js-profile-add-new-address input[type='text']").focusout(function(){$(this).data("required")&&0===$(this).val().trim().length?$(this).addClass("error-mandatory"):$(this).removeClass("error-mandatory")}),$(".js-profile-edit-address input[type='text']").focusout(function(){$(this).data("required")&&0===$(this).val().trim().length?$(this).addClass("error-mandatory"):$(this).removeClass("error-mandatory")}),$(".js-profile-add-new-billing-address input[type='text']").focusout(function(){$(this).data("required")&&0===$(this).val().trim().length?$(this).addClass("error-mandatory"):$(this).removeClass("error-mandatory")})},displaySuccessMessage:function(){$("div.global-alerts").html("<div class='alert alert-info alert-dismissable'>".concat(ACC.addedAddress,"</div>"))},displayUpdatedMessage:function(){$("div.global-alerts").html("<div class='alert alert-info alert-dismissable'>".concat(ACC.updatedAddress,"</div>"))}};window.ACC.address=ACC.address||{},ACC.address=_mergeThemeToBase(window.ACC.address,vnAddress,"address");var checkout={_autoload:[["bindCheckO",$(".checkout-content").length>0],["bindCheckConfirmation",$(".checkout-confirmation-content").length>0],["cleanCheckbox",$(".checkout-content").length>0]],parcelPoint:null,_DEBUG:!1,isFormValidating:!1,continueButtonEnabled:!1,lastSameBillingStateAtAddressTab:!0,setContinueButtonState:function(e){ACC.checkout.continueButtonEnabled=e,$("#deliveryOptionsSubmit").trigger("button.state.changed",[e])},validationCandidateGroup:["#shipping-header-detail","#shipping-address-detail","#billing-address-detail"],validationExemptedFields:["receiveSmsDelivery","shippingAddress.saveInAddressBook","billingAddress.saveInAddressBook","shipping-qas","billing-qas"],validationPaymentGroup:[],bindCheckO:function(){$(".doFlowSelectedChange").change(function(){"multistep-pci"===$("#selectAltCheckoutFlow").attr("value")?$("#selectPciOption").css("display",""):$("#selectPciOption").css("display","none")}),$(".continueShoppingButton").click(function(){var e=$(this).data("continueShoppingUrl");window.location=e}),$(".expressCheckoutButton").click(function(){document.getElementById("expressCheckoutCheckbox").checked=!0}),$(document).on("input",".confirmGuestEmail,.guestEmail",function(){$(".guestEmail").val()===$(".confirmGuestEmail").val()?$(".guestCheckoutBtn").removeAttr("disabled"):$(".guestCheckoutBtn").attr("disabled","disabled")}),$(".checkoutButton").click(function(){var e=$(this).data("checkoutUrl"),t=$("html").data("login")?ACC.netfunnel.actionIds.shipment:ACC.netfunnel.actionIds.checkoutLogin;if(!ACC.pickupinstore.validatePickupinStoreCartEntires()){var i=$(".express-checkout-checkbox");if(i.is(":checked"))ACC.netfunnel.action({action_id:t},function(){window.location=i.data("expressCheckoutUrl")});else{var s=$("#selectAltCheckoutFlow").attr("value");if(void 0===s||""===s)ACC.netfunnel.action({action_id:t},function(){window.location=e});else{"multistep-pci"===s&&(s="multistep");var d=$("#selectPciOption").attr("value"),a="".concat(e,"/select-flow?flow=").concat(s,"&pci=").concat(d);ACC.netfunnel.action({action_id:t},function(){window.location=a})}}}return!1})},bindCheckConfirmation:function(){$(".continueShoppingButton").click(function(){var e=$(this).data("continue-shopping-url");window.location=e})},selectedDeliveryMode:"",displayCreditCardAddressForm:function(e,t){$.ajax({url:"".concat(ACC.config.encodedContextPath,"/checkout/multi/payment-method/adyenbillingaddressform"),async:!0,data:e,dataType:"html"}).done(function(e){$("#billingAddressForm").html(e),"function"==typeof t&&t.call()})},cleanCheckbox:function(){$(".checkbox").each(function(){var e=$(this).find('input[type="checkbox"].checkbox-input').attr("name"),t=$(this).find('input[name="_'.concat(e,'"]')),i=$(this).find(".checkbox-label");t.length&&t.insertAfter(i)})}};window.ACC.checkout=ACC.checkout||{},ACC.checkout=_mergeThemeToBase(window.ACC.checkout,checkout,"checkout");var global={_autoload:["logoFocus"],logoFocus:function(){$(".js-mobile-logo").focusin(function(){$("main").hasClass("offcanvas")&&(ACC.global.toggleClassState($("main"),"offcanvas"),ACC.global.toggleClassState($("html"),"offcanvas"),ACC.global.toggleClassState($("body"),"offcanvas"))})}};window.ACC.global=ACC.global||{},ACC.global=_mergeThemeToBase(window.ACC.global,global,"global");var product={_autoload:[["filterWebAccessibility",$("#js-mobile-filter-wrapper").length>0]],filterWebAccessibility:function(){var e=$(".mobile-menu-close"),t=!1;$(".mobile-button-slide-left").click(function(){t=!0}),$(".mobile-button-slide-left-sort").click(function(){t=!1}),$(e).bind("touchstart click",function(){$(this).blur(),t?$(".js-mobile-facet-tab .mobile-button-slide-left").focus():$(".js-mobile-facet-tab .mobile-button-slide-left-sort").focus()})}};window.ACC.product=ACC.product||{},ACC.product=_mergeThemeToBase(window.ACC.product,product,"product");
